
<div id='status'>
	<div id='solr-server'>
		<h2>POWER</h2>
		<% if @solr_running %>
			<%= link_to raw("
			<div class='power_button_base_border'>
				<div class='power_button_base_gradient'>
					<div class='power_button_inner_glow'>
						<div class='power_button_top'>
								<div class='power_button_light_rim_on'>
									<div class='power_button_light_on'>
									</div><!--power_button_light_on-->
								</div><!--power_button_light_rim_on-->
						</div><!--power_button_top-->
						<div class='power_button_bottom'>
						</div><!--power_button_bottom-->
						<div class='power_button_flare'>
						</div><!--power_button_flare-->
					</div><!--power_button_inner_glow-->
				</div><!--power_button_base_gradient-->
			</div> <!--power_button_base_border-->
			"), :action => :stop_solr, :controller => :sunspot_admin %>
		<% else %>
			<%= link_to raw("
			<div class='power_button_base_border'>
				<div class='power_button_base_gradient'>
					<div class='power_button_inner_glow_off'>
						<div class='power_button_top_off'>
						</div><!--power_button_top_off-->
						<div class='power_button_bottom_off'>
						</div><!--power_button_bottom_off-->
						<div class='power_button_flare_off'>
						</div><!--power_button_flare_off-->
						<div class='power_button_light_rim_off'>
							<div class='power_button_light_off'>
							</div><!--power_button_light_off-->
						</div><!--power_button_light_rim_off-->
					</div><!--power_button_inner_glow_off-->
				</div><!--power_button_base_gradient-->
			</div> <!--power_button_base_border-->
			"), :action => :start_solr, :controller => :sunspot_admin %>
		<% end %>
	</div>
	<div id='server-status'>
		<h2>SERVER STATUS</h2>
		<% if !@searchable && !@solr_running%>
			<div class="search_off">
				<div class="item_display">
					<div class="text"><strong>Search not enabled!<br />Select attributes &<br />turn Solr on</strong></div>
				</div><!--item display-->
			</div> <!--search_off-->
		<% elsif !@solr_running%>
			<div class="search_off">
				<div class="item_display">
					<div class="text"><strong>Search not enabled!<br />Turn Solr on</strong></div>
				</div><!--item display-->
			</div> <!--search_off-->
		<% elsif ( !@unprepared.blank? && @unprepared.count > 0) || ( !@prepared.blank? && @prepared.count > 0) %>
			<div class="search_off">
				<div class="item_display">
					<div class="text"><strong>Search not enabled!<br />Index your database</strong></div>
				</div><!--item display-->
			</div> <!--search_off-->
		<% elsif !@indexed.blank? && @indexed.count > 0 %>
			<div class="search_on">
				<div class="item_display">
					<div class="text"><strong>Everything is cool over here!<br/>You may start searching...</strong></div>
				</div><!--item display-->
			</div> <!--search_on-->
		<% else %>
			<div class="search_off">
				<div class="item_display">
					<div class="text"><strong>Search not enabled!<br />Select attributes for indexing</strong></div>
				</div><!--item display-->
			</div> <!--search_off-->
		<% end %>
	</div>
	<div id='index'>
		<h2>INDEX</h2>
		<% if @searchable && @solr_running && @unprepared.flatten.blank? && @prepared.flatten.blank? %>
			<%= link_to raw("
			<div class='index_button_base_border'>
				<div class='index_button_base_gradient'>
					<div class='index_button_rim_pressed'>
						<div class='index_button_fill_pressed'></div><!--index_button_fill_pressed-->
					</div><!--index_button_rim_pressed-->
				</div><!--index_button_base_border-->
			</div> <!--index_button_base_gradient-->
			"), :action => :make_searchable_and_reindex, :controller => :sunspot_admin  %>
		<% elsif @solr_running && (@unprepared.blank? || @prepared.blank?) %>
			<%= link_to raw("
			<div class='index_button_base_border'>
				<div class='index_button_base_gradient'>
					<div class='index_button_rim'>
						<div class='index_button_fill'></div><!--index_button_fill-->
					</div><!--index_button_rim-->
				</div><!--index_button_base_border-->
			</div> <!--index_button_base_gradient-->
			"), :action => :make_searchable_and_reindex, :controller => :sunspot_admin  %>
		<% else %>
			<div class='index_button_base_border'>
				<div class='index_button_base_gradient'>
					<div class='index_button_rim'>
						<div class='index_button_fill'></div><!--index_button_fill-->
					</div><!--index_button_rim-->
				</div><!--index_button_base_border-->
			</div> <!--index_button_base_gradient-->
		<% end %>
	</div>
</div>


<div id='items'>
	<% @models.each_pair do |name, value| %>
		<div class ='model'>
			<h2><%= link_to_function display_model_name(name), "$('#{idify_model_name(name)}-items').toggle()" %></h2>
			<div id="<%= idify_model_name(name) %>-items">
				<% i = 0 %>
				<% value[:attributes].each_pair do |attribute, type| %>
					<% item = { :name => name, :attribute => attribute, :type => type } %>
					<% added_check = @added.inject(false) { |is_added, each| is_added || each.is_model_and_attribute(name, attribute) } %>
					<% indexed = @indexed.inject(false) { |is_indexed, each| is_indexed || each.is_model_and_attribute(name, attribute) } == true ? "indexed" : "unindexed" %>
					<% column = ((i % 2) == 0 ) ? 'first_column': 'second_column' %>
					<% i += 1 %>
					<div class='item <%= column %>'>
						<%=raw display_item_add_button item, added_check %>
						<%=raw display_item_indexed_light item, indexed %>
						<%=raw display_item_display item, indexed %>
					</div>
				<% end unless value[:attributes].blank? %>
			</div>
			<div class='clear'><br /></div>
		</div>
	<% end unless @models.blank? %>
</div>